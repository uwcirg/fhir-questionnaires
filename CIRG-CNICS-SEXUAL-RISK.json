{
  "resourceType": "Questionnaire",
  "id": "CIRG-CNICS-SEXUAL-RISK",
  "title": "CNICS Sexual Risk Questionnaire - LOTS TODO HERE FIXME, SIMPLY COPIED FROM THE AUDIT",
  "status": "active",
  "description": "CNICS Sexual Risk Questionnaire. Based on: Fredericksen RJ, Mayer KH, Gibbons LE, et al. Development and Content Validation of a Patient-Reported Sexual Risk Measure for Use in Primary Care. J Gen Intern Med. 2018.",
  "item": [
    {
      "linkId": "SEXUAL-RISK-header",
      "text": "This portion of the questionnaire is about your use of alcoholic beverages during the PAST TWELVE MONTHS.",
      "type": "display"
    },
    {
      "linkId": "SEXUAL-RISK-0",
      "text": "How often do you have a drink containing alcohol?",
      "type": "choice",
      "answerOption": [
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-0-0",
            "display": "Never",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 0
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-0-1",
            "display": "Monthly or less",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 1 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-0-2",
            "display": "2 to 4 times a month",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 2
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-0-3",
            "display": "2 to 3 times a week",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 3 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-0-4",
            "display": "4 to 5 times a week",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 4 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-0-5",
            "display": "6 or 7 times a week",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 4 
                }
            ]
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-Q0-score",
      "text": "Score contribution from Q0. This is an internal item for other scores' calculations.",
      "type": "decimal",
      "readOnly": true,
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "iif(%resource.item.where(linkId='SEXUAL-RISK-0').answer.empty(), null, %resource.item.where(linkId='SEXUAL-RISK-0').answer.valueCoding.extension('http://hl7.org/fhir/StructureDefinition/ordinalValue').valueDecimal.toInteger())"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-1",
      "text": "How many drinks containing alcohol do you have on a typical day when you are drinking?",
      "type": "choice",
      "answerOption": [
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-1-0",
            "display": "1",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 0
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-1-1",
            "display": "2",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 0
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-1-2",
            "display": "3",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 1
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-1-3",
            "display": "4",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 1
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-1-4",
            "display": "5",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 2
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-1-5",
            "display": "6",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 2 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-1-6",
            "display": "7",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 3 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-1-7",
            "display": "8",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 3 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-1-8",
            "display": "9",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 3 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-1-9",
            "display": "10 or more",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 4 
                }
            ]
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-enableWhenExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "%resource.item.where(linkId='SEXUAL-RISK-0').answer.valueCoding.code != 'SEXUAL-RISK-0-0'"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-2-not-male",
      "text": "How often do you have four or more drinks on one occasion?",
      "type": "choice",
      "answerOption": [
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-2-not-male-0",
            "display": "Never",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 0 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-2-not-male-1",
            "display": "Less than monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 1
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-2-not-male-2",
            "display": "Monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 2
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-2-not-male-3",
            "display": "Weekly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 3
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-2-not-male-4",
            "display": "Daily or almost daily",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 4
                }
            ]
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-enableWhenExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "((%patient.gender != 'male') or %patient.gender.exists() != true) and %resource.item.where(linkId='SEXUAL-RISK-0').answer.valueCoding.code != 'SEXUAL-RISK-0-0'"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-2-male",
      "text": "How often do you have five or more drinks on one occasion?",
      "type": "choice",
      "answerOption": [
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-2-male-0",
            "display": "Never",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 0
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-2-male-1",
            "display": "Less than monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 1
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-2-male-2",
            "display": "Monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 2
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-2-male-3",
            "display": "Weekly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 3 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-2-male-4",
            "display": "Daily or almost daily",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 4 
                }
            ]
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-enableWhenExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "%patient.gender.exists() and (%patient.gender = 'male') and (%resource.item.where(linkId='SEXUAL-RISK-0').answer.valueCoding.code != 'SEXUAL-RISK-0-0')"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-Q1-Q2-score",
      "text": "Score contribution from Q1 & Q2. This is an internal item for other scores' calculations.",
      "type": "decimal",
      "readOnly": true,
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "(iif(%resource.item.where(linkId='SEXUAL-RISK-1').answer.empty(), 0, %resource.item.where(linkId='SEXUAL-RISK-1').answer.valueCoding.extension('http://hl7.org/fhir/StructureDefinition/ordinalValue').valueDecimal.toInteger()) + iif(%resource.item.where(linkId='SEXUAL-RISK-2-not-male').answer.empty(), 0, %resource.item.where(linkId='SEXUAL-RISK-2-not-male').answer.valueCoding.extension('http://hl7.org/fhir/StructureDefinition/ordinalValue').valueDecimal.toInteger()) + iif(%resource.item.where(linkId='SEXUAL-RISK-2-male').answer.empty(), 0, %resource.item.where(linkId='SEXUAL-RISK-2-male').answer.valueCoding.extension('http://hl7.org/fhir/StructureDefinition/ordinalValue').valueDecimal.toInteger()))"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-C-complete",
      "text": "SEXUAL-RISK-C part of questionnaire (first three questions) complete. This is an internal item for other scores' calculations.",
      "type": "boolean",
      "readOnly": true,
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "%resource.item.where(linkId = 'SEXUAL-RISK-0').answer.valueCoding.code.exists() and (%resource.item.where(linkId = 'SEXUAL-RISK-0').answer.valueCoding.code = 'SEXUAL-RISK-0-0') or (%resource.item.where(linkId = 'SEXUAL-RISK-1').answer.valueCoding.code.exists() and (%resource.item.where(linkId = 'SEXUAL-RISK-2-not-male').answer.valueCoding.code.exists() or %resource.item.where(linkId = 'SEXUAL-RISK-2-male').answer.valueCoding.code.exists()))"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-C-score",
      "text": "SEXUAL-RISK-C score (score for questions 0-2)",
      "type": "decimal",
      "readOnly": true,
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "%resource.item.where(linkId='SEXUAL-RISK-Q0-score').answer.valueDecimal.toInteger() + %resource.item.where(linkId='SEXUAL-RISK-Q1-Q2-score').answer.valueDecimal.toInteger()"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-C-score-interpretation",
      "text": "CNICS SEXUAL-RISK-C score interpretation",
      "type": "string",
      "readOnly": true,
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "iif(%patient.gender = 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 4, 'At-risk', iif(%patient.gender != 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 3, 'At-risk', iif((%resource.item.where(linkId='SEXUAL-RISK-C-score').answer.empty() != true), 'Not at-risk', null)))"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-3",
      "text": "How often during the past 12 months have you found that you were not able to stop drinking once you had started?",
      "type": "choice",
      "answerOption": [
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-3-0",
            "display": "Never",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 0
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-3-1",
            "display": "Less than monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 1
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-3-2",
            "display": "Monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 2
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-3-3",
            "display": "Weekly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 3 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-3-4",
            "display": "Daily or almost daily",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 4 
                }
            ]
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-enableWhenExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "(%resource.item.where(linkId='SEXUAL-RISK-0').answer.valueCoding.code != 'SEXUAL-RISK-0-0' and (iif(%patient.gender = 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 4, true, iif(%patient.gender != 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 3), true, false)))"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-4",
      "text": "How often during the past 12 months have you failed to do what was normally expected from you because of drinking?",
      "type": "choice",
      "answerOption": [
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-4-0",
            "display": "Never",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 0
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-4-1",
            "display": "Less than monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 1
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-4-2",
            "display": "Monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 2
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-4-3",
            "display": "Weekly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 3 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-4-4",
            "display": "Daily or almost daily",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 4 
                }
            ]
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-enableWhenExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "(%resource.item.where(linkId='SEXUAL-RISK-0').answer.valueCoding.code != 'SEXUAL-RISK-0-0' and (iif(%patient.gender = 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 4, true, iif(%patient.gender != 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 3), true, false)))"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-5",
      "text": "How often during the past 12 months have you needed a first drink in the morning to get yourself going after a heavy drinking session?",
      "type": "choice",
      "answerOption": [
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-5-0",
            "display": "Never",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 0
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-5-1",
            "display": "Less than monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 1
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-5-2",
            "display": "Monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 2
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-5-3",
            "display": "Weekly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 3 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-5-4",
            "display": "Daily or almost daily",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 4 
                }
            ]
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-enableWhenExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "(%resource.item.where(linkId='SEXUAL-RISK-0').answer.valueCoding.code != 'SEXUAL-RISK-0-0' and (iif(%patient.gender = 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 4, true, iif(%patient.gender != 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 3), true, false)))"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-6",
      "text": "How often during the past 12 months have you had a feeling of guilt or remorse after drinking?",
      "type": "choice",
      "answerOption": [
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-6-0",
            "display": "Never",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 0
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-6-1",
            "display": "Less than monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 1
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-6-2",
            "display": "Monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 2
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-6-3",
            "display": "Weekly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 3 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-6-4",
            "display": "Daily or almost daily",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 4 
                }
            ]
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-enableWhenExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "(%resource.item.where(linkId='SEXUAL-RISK-0').answer.valueCoding.code != 'SEXUAL-RISK-0-0' and (iif(%patient.gender = 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 4, true, iif(%patient.gender != 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 3), true, false)))"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-7",
      "text": "How often during the past 12 months have you been unable to remember what happened the night before because you had been drinking?",
      "type": "choice",
      "answerOption": [
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-7-0",
            "display": "Never",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 0
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-7-1",
            "display": "Less than monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 1
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-7-2",
            "display": "Monthly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 2
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-7-3",
            "display": "Weekly",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 3 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-7-4",
            "display": "Daily or almost daily",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 4 
                }
            ]
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-enableWhenExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "(%resource.item.where(linkId='SEXUAL-RISK-0').answer.valueCoding.code != 'SEXUAL-RISK-0-0' and (iif(%patient.gender = 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 4, true, iif(%patient.gender != 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 3), true, false)))"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-8",
      "text": "Have you or someone else been injured as a result of your drinking?",
      "type": "choice",
      "answerOption": [
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-8-0",
            "display": "No",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 0 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-8-1",
            "display": "Yes, but not in the last 12 months",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 2
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-8-2",
            "display": "Yes, during last 12 months",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 4
                }
            ]
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-enableWhenExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "(%resource.item.where(linkId='SEXUAL-RISK-0').answer.valueCoding.code != 'SEXUAL-RISK-0-0' and (iif(%patient.gender = 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 4, true, iif(%patient.gender != 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 3), true, false)))"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-9",
      "text": "Has a relative or friend or a doctor or another health worker been concerned about your drinking or suggested you cut down?",
      "type": "choice",
      "answerOption": [
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-9-0",
            "display": "No",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 0 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-9-1",
            "display": "Yes, but not in the last 12 months",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 2 
                }
            ]
          }
        },
        {
          "valueCoding": {
            "code": "SEXUAL-RISK-9-2",
            "display": "Yes, during last 12 months",
            "extension": [
                {
                    "url": "http://hl7.org/fhir/StructureDefinition/ordinalValue",
                    "valueDecimal": 4
                }
            ]
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-enableWhenExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "(%resource.item.where(linkId='SEXUAL-RISK-0').answer.valueCoding.code != 'SEXUAL-RISK-0-0' and (iif(%patient.gender = 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 4, true, iif(%patient.gender != 'male' and %resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 3), true, false)))"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-last-7-any-answers",
      "text": "At least one of the last 7 questions has been answered. This is an internal item for other scores' calculations.",
      "type": "boolean",
      "readOnly": true,
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "%resource.item.where(linkId = 'SEXUAL-RISK-3').answer.valueCoding.code.exists() or %resource.item.where(linkId = 'SEXUAL-RISK-4').answer.valueCoding.code.exists() or %resource.item.where(linkId = 'SEXUAL-RISK-5').answer.valueCoding.code.exists() or %resource.item.where(linkId = 'SEXUAL-RISK-6').answer.valueCoding.code.exists() or %resource.item.where(linkId = 'SEXUAL-RISK-7').answer.valueCoding.code.exists() or %resource.item.where(linkId = 'SEXUAL-RISK-8').answer.valueCoding.code.exists() or %resource.item.where(linkId = 'SEXUAL-RISK-9').answer.valueCoding.code.exists()"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-last-7-complete",
      "text": "Last 7 questions here have been answered. This is an internal item for other scores' calculations.",
      "type": "boolean",
      "readOnly": true,
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "%resource.item.where(linkId = 'SEXUAL-RISK-3').answer.valueCoding.code.exists() and %resource.item.where(linkId = 'SEXUAL-RISK-4').answer.valueCoding.code.exists() and %resource.item.where(linkId = 'SEXUAL-RISK-5').answer.valueCoding.code.exists() and %resource.item.where(linkId = 'SEXUAL-RISK-6').answer.valueCoding.code.exists() and %resource.item.where(linkId = 'SEXUAL-RISK-7').answer.valueCoding.code.exists() and %resource.item.where(linkId = 'SEXUAL-RISK-8').answer.valueCoding.code.exists() and %resource.item.where(linkId = 'SEXUAL-RISK-9').answer.valueCoding.code.exists()"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-complete",
      "text": "SEXUAL-RISK questionnaire complete",
      "type": "boolean",
      "readOnly": true,
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "(%resource.item.where(linkId='SEXUAL-RISK-C-complete').answer.valueBoolean.toBoolean() = true and (iif((%resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 4 and (%patient.gender = 'male')) and %resource.item.where(linkId='SEXUAL-RISK-last-7-complete').answer.valueBoolean.toBoolean() = true, true,   (iif((%resource.item.where(linkId='SEXUAL-RISK-C-score').answer.valueDecimal.toInteger() >= 3 and (%patient.gender != 'male')) and %resource.item.where(linkId='SEXUAL-RISK-last-7-complete').answer.valueBoolean.toBoolean() = true, true, false)))))"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-score",
      "text": "CNICS SEXUAL-RISK score",
      "type": "decimal",
      "readOnly": true,
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "(%resource.item.where(linkId='SEXUAL-RISK-Q0-score').answer.valueDecimal.toInteger() + %resource.item.where(linkId='SEXUAL-RISK-Q1-Q2-score').answer.valueDecimal.toInteger() + iif(%resource.item.where(linkId='SEXUAL-RISK-3').answer.empty(), 0, %resource.item.where(linkId='SEXUAL-RISK-3').answer.valueCoding.extension('http://hl7.org/fhir/StructureDefinition/ordinalValue').valueDecimal.toInteger()) + iif(%resource.item.where(linkId='SEXUAL-RISK-4').answer.empty(), 0, %resource.item.where(linkId='SEXUAL-RISK-4').answer.valueCoding.extension('http://hl7.org/fhir/StructureDefinition/ordinalValue').valueDecimal.toInteger()) + iif(%resource.item.where(linkId='SEXUAL-RISK-5').answer.empty(), 0, %resource.item.where(linkId='SEXUAL-RISK-5').answer.valueCoding.extension('http://hl7.org/fhir/StructureDefinition/ordinalValue').valueDecimal.toInteger()) + iif(%resource.item.where(linkId='SEXUAL-RISK-6').answer.empty(), 0, %resource.item.where(linkId='SEXUAL-RISK-6').answer.valueCoding.extension('http://hl7.org/fhir/StructureDefinition/ordinalValue').valueDecimal.toInteger()) + iif(%resource.item.where(linkId='SEXUAL-RISK-7').answer.empty(), 0, %resource.item.where(linkId='SEXUAL-RISK-7').answer.valueCoding.extension('http://hl7.org/fhir/StructureDefinition/ordinalValue').valueDecimal.toInteger()) + iif(%resource.item.where(linkId='SEXUAL-RISK-8').answer.empty(), 0, %resource.item.where(linkId='SEXUAL-RISK-8').answer.valueCoding.extension('http://hl7.org/fhir/StructureDefinition/ordinalValue').valueDecimal.toInteger()) + iif(%resource.item.where(linkId='SEXUAL-RISK-9').answer.empty(), 0, %resource.item.where(linkId='SEXUAL-RISK-9').answer.valueCoding.extension('http://hl7.org/fhir/StructureDefinition/ordinalValue').valueDecimal.toInteger()))"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-score-interpretation",
      "text": "CNICS SEXUAL-RISK score interpretation",
      "type": "string",
      "readOnly": true,
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "iif(%patient.gender = 'male' and %resource.item.where(linkId='SEXUAL-RISK-score').answer.valueDecimal.toInteger() >= 6, 'At-risk', iif(%patient.gender != 'male' and %resource.item.where(linkId='SEXUAL-RISK-score').answer.valueDecimal.toInteger() >= 5, 'At-risk', iif((%resource.item.where(linkId='SEXUAL-RISK-score').answer.empty() != true), 'Not at-risk', null)))"
          }
        }
      ]
    },
    {
      "linkId": "SEXUAL-RISK-qnr-to-report",
      "text": "Which CNICS SEXUAL-RISK score to display. Returns 'SEXUAL-RISK', 'SEXUAL-RISK-C', or null.",
      "type": "string",
      "readOnly": true,
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-calculatedExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "iif(%resource.item.where(linkId='SEXUAL-RISK-last-7-any-answers').answer.valueBoolean.toBoolean() = true, 'SEXUAL-RISK', iif(%resource.item.where(linkId='SEXUAL-RISK-0').answer.empty() = false, 'SEXUAL-RISK-C', null))"
          }
        }
      ]
    }
  ]
}
